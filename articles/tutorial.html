<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="GST">
<title>GST Tutorial • GST</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Montserrat-0.4.9/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="GST Tutorial">
<meta property="og:description" content="GST">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">GST</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/tutorial.html">GST Tutorial</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>GST Tutorial</h1>
                        <h4 data-toc-skip class="author">Jiaxin
Huang</h4>
                        
      
      
      <div class="d-none name"><code>tutorial.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jh277.github.io/GST/">GST</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction-to-the-use-of-global-statistical-approach">Introduction to the use of Global Statistical Approach<a class="anchor" aria-label="anchor" href="#introduction-to-the-use-of-global-statistical-approach"></a>
</h2>
<p>Determination whether one treatment is preferred over others is a
major goal of many clinical studies but can be complicated by the
situation when no single outcome is sufficient to make the judgement.
This package introduces a useful global statistics test technique and
the corresponding global treatment effect (GTE) measure, which employs a
nonparametric method based on a composite rank-sum of diverse variables
for assessing treatment’s global preference when multiple outcomes are
evaluated together.</p>
<p>Measure of treatment benefit for each outcome is defined as <span class="math inline">\(\theta = p - q\)</span> which is the difference
between the probability that the treatment is better than the control
and the probability that the control is better than the treatment. When
there are multiple outcomes, compute such <span class="math inline">\(\theta\)</span> for each outcome and take an
average <span class="math inline">\(\bar{\theta}\)</span> of these
values.This <span class="math inline">\(\bar{\theta}\)</span> value is
called the global treatment effect (GTE)</p>
<p>Interpretation of GTE is very straightforward: GTE = 0. indicates no
global difference between treatment 1 and 2, GTE &gt; 0 indicates
treatment 2 gives globally higher values than treatment 1 and GTE &lt; 0
indicates treamtent 2 gives globally smaller values than treatment 1.
GTE values approaching 1 implies an increased treatment 2’s global
values over treatment 1, whereas GTE values approaching -1 suggest a
decreased treatment 2’s global values over treatment 1.</p>
<p>O’Brien’s rank-sum type GST is a simple useful method to compare a
treatment’s global effect on multiple outcomes. Once an appropriate
<span class="math inline">\(\bar{\theta}_a\)</span> value for the target
magnitude of treatment effect is determined, one is ready to set up
hypotheses, compute the sample size needed, and test the treatment
global effect using O’Brien’s GST after the data are collected.
Determination of global treatment effect, computation of sample size and
testing of GTE using functions included in this package are illustrated
in Part I, II and III respectively.</p>
<div class="section level3">
<h3 id="part-i--determination-of-the-global-treatment-effect">Part I. Determination of the global treatment effect<a class="anchor" aria-label="anchor" href="#part-i--determination-of-the-global-treatment-effect"></a>
</h3>
<p>This section describes how to compute the global treatment effect
<span class="math inline">\(\bar{\theta}\)</span> from pilot data (if
they are available) or summary statistics (if pilot data is not
available).</p>
<p><strong>When there are pilot data</strong></p>
<p>When there are pilot data, we can directly use the theta function in
this package. <strong>Data has to been consistently coded to ensure that
larger values indicate better outcomes for all measures.</strong></p>
<div class="float">
<img src="images/data.png" alt="Data Structure: The K Outcomes are Denoted by V1, V2, …, and VK. The Entries are Observations from Patients"><div class="figcaption">Data Structure: The K Outcomes are Denoted by
V1, V2, …, and VK. The Entries are Observations from Patients</div>
</div>
<p>Example: x1 is 100 random samples from a t-distribution with 50
degrees of freedom, while x2 is 100 random samples from a t-distribution
with 2 degrees of freedom. We treat x1 as outcomes from group 1 and x2
as outcomes from group 2 in pilot data. The <span class="math inline">\(\bar{\theta}\)</span> is calculated as follow:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">x1</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">rt</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">50</span>, ncp <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">x2</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">rt</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">2</span>, ncp <span class="op">=</span> <span class="fl">10.3</span><span class="op">)</span></span>
<span><span class="co"># use original data:</span></span>
<span><span class="va">theta_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/theta.html">theta</a></span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span><span class="op">)</span> </span>
<span><span class="va">theta_1</span></span>
<span><span class="co">#&gt; [1] 0.3056</span></span>
<span><span class="co"># effect size when comparing x1 and x2:</span></span>
<span><span class="va">effect_size1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Under this scenario, the global treatment effect <span class="math inline">\(\bar{\theta}\)</span> = 0.3056, indicating that
group 2 gives globally higher values than group 1.</p>
<p><strong>When there is no pilot data, or we only have summary
statistics</strong></p>
<p>When there are no pilot data, investigators can estimate the
treatment effect based on information from the literature. In most
cases, such information is presented in terms of mean and standard
deviation using normal approximation, or presented using summary
statistics of other parametric distributions.</p>
<p>In some studies, nonlinear monotone transformations (eg., log
transformation, square root transformations, etc.) were applied to the
data to obtain a better parametric approximation, and only summary
statistics of the transformed data were reported. Fortunately, this is
not a problem when GTE is used to measure a treatment’s effect since the
GTE is unchanged as it is computed only from the observation ranks.</p>
<p>Here is a brief illustration of the GTE’s invariance property to
nonlinear monotone transformation:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># take log-transformation of the data:</span></span>
<span><span class="va">y1</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span></span>
<span><span class="va">y2</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span></span>
<span><span class="co"># theta:</span></span>
<span><span class="va">theta_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/theta.html">theta</a></span><span class="op">(</span><span class="va">y1</span>,<span class="va">y2</span><span class="op">)</span></span>
<span><span class="co"># effect size when comparing y1 and y2:</span></span>
<span><span class="va">effect_size2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y1</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y2</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y1</span>,<span class="va">y2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># take square transformation of the data:</span></span>
<span><span class="va">z1</span><span class="op">&lt;-</span> <span class="va">x1</span><span class="op">^</span><span class="fl">3</span></span>
<span><span class="va">z2</span><span class="op">&lt;-</span> <span class="va">x2</span><span class="op">^</span><span class="fl">3</span></span>
<span><span class="co"># theta:</span></span>
<span><span class="va">theta_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/theta.html">theta</a></span><span class="op">(</span><span class="va">z1</span>,<span class="va">z2</span><span class="op">)</span> </span>
<span><span class="co"># effect size when comparing z1 and z2:</span></span>
<span><span class="va">effect_size3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">z1</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">z2</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">z1</span>,<span class="va">z2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">compare</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">theta_1</span>, <span class="va">theta_2</span>, <span class="va">theta_3</span>, </span>
<span>                                <span class="va">effect_size1</span>, <span class="va">effect_size2</span>, <span class="va">effect_size3</span><span class="op">)</span>,</span>
<span>                                nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">compare</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GTE"</span>, <span class="st">"Effect size"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">compare</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Normal"</span>, <span class="st">"Log-transformed"</span>, <span class="st">"square_transformed"</span><span class="op">)</span></span>
<span><span class="va">compare</span></span>
<span><span class="co">#&gt;                       GTE Effect size</span></span>
<span><span class="co">#&gt; Normal             0.3056   0.4794255</span></span>
<span><span class="co">#&gt; Log-transformed    0.3056   0.5697520</span></span>
<span><span class="co">#&gt; square_transformed 0.3056   0.1708347</span></span></code></pre></div>
<p>As the table shows, the GTE do not change after applying nonlinear
monotone transformation while the effect size varies significantly.</p>
<p>Example:</p>
<p>Suppose we have hypothetical summary statistics using normal
approximation as shown below.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">stdev1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">mu2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">40</span>, <span class="fl">70</span><span class="op">)</span></span>
<span><span class="va">stdev2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span><span class="op">)</span></span>
<span></span>
<span><span class="va">summary_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Outcome_Scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Outcome 1"</span>, <span class="st">"Outcome 2"</span>, <span class="st">"Outcome 3"</span><span class="op">)</span>,</span>
<span>  Placebo_Mean <span class="op">=</span> <span class="va">mu1</span>,</span>
<span>  Placebo_SD <span class="op">=</span> <span class="va">stdev1</span>,</span>
<span>  Treatment_Mean <span class="op">=</span> <span class="va">mu2</span>,</span>
<span>  Treatment_SD <span class="op">=</span> <span class="va">stdev2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">summary_data</span>, </span>
<span>      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Outcome scale"</span>, <span class="st">"Placebo Mean"</span>, <span class="st">"Placebo SD"</span>, <span class="st">"Treatment Mean"</span>, <span class="st">"Treatment SD"</span><span class="op">)</span>, </span>
<span>      align <span class="op">=</span> <span class="st">'c'</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="21%">
<col width="19%">
<col width="16%">
<col width="22%">
<col width="19%">
</colgroup>
<thead><tr class="header">
<th align="center">Outcome scale</th>
<th align="center">Placebo Mean</th>
<th align="center">Placebo SD</th>
<th align="center">Treatment Mean</th>
<th align="center">Treatment SD</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">Outcome 1</td>
<td align="center">30</td>
<td align="center">3</td>
<td align="center">10</td>
<td align="center">5</td>
</tr>
<tr class="even">
<td align="center">Outcome 2</td>
<td align="center">40</td>
<td align="center">4</td>
<td align="center">40</td>
<td align="center">6</td>
</tr>
<tr class="odd">
<td align="center">Outcome 3</td>
<td align="center">50</td>
<td align="center">5</td>
<td align="center">70</td>
<td align="center">7</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">mu2</span><span class="op">-</span><span class="va">mu1</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">stdev1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">stdev2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span></span>
<span><span class="va">theta</span></span>
<span><span class="co">#&gt; [1] -0.9993964  0.0000000  0.9799255</span></span></code></pre></div>
<p>For outcome 1, group 2(treatment) gives globally smaller values than
group 1 (control). For outcome 2, there is no global difference between
group 1 and 2. For outcome 3, group 2 gives globally higher values than
group 1.</p>
</div>
<div class="section level3">
<h3 id="part-ii--determination-of-sample-size">Part II. Determination of sample size<a class="anchor" aria-label="anchor" href="#part-ii--determination-of-sample-size"></a>
</h3>
<p><strong>Sample size estimation when some historical data are
available</strong></p>
<p>We could use N.GSTwPilotData function to derive the sample size when
there is some pilot data.</p>
<p>Functions required inputs are: 1. data: a (m1+m2)xk matrix of pilot
data with its first m1 rows from treatment 1,<br>
and the rest m2 rows from treatment 2. k is the number of endpoints 2.
m1: number of patients in treatment 1 in the pilot data 3. r0:
randomization ratio in new study = n2/n1 4. test.side: 1(one-sided test)
or 2 (two-sided test) 5. alpha: type I error to be controlled 6. power:
statistical power to be controlled 7. GTE: global treatment effect where
power is controlled at.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># hypothetical pilot data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">k</span><span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">n1</span><span class="op">&lt;-</span> <span class="fl">40</span></span>
<span><span class="va">N</span><span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">n2</span><span class="op">&lt;-</span> <span class="va">N</span><span class="op">-</span><span class="va">n1</span></span>
<span><span class="va">x1</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>              <span class="va">x1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>              <span class="va">x1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x2</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n2</span>, mean<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="va">data2</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x2</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>              <span class="va">x2</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>              <span class="va">x2</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">[</span><span class="op">(</span><span class="va">n1</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">N</span>,<span class="op">]</span><span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="op">(</span><span class="va">n1</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">N</span>,<span class="op">]</span><span class="op">+</span><span class="va">data2</span></span>
<span><span class="co"># calculate sample size</span></span>
<span><span class="fu"><a href="../reference/N.GSTwPilotData.html">N.GSTwPilotData</a></span><span class="op">(</span><span class="va">data</span>, m1<span class="op">=</span><span class="va">n1</span>, </span>
<span>  r0<span class="op">=</span><span class="va">n2</span><span class="op">/</span><span class="va">n1</span>, test.side<span class="op">=</span><span class="fl">2</span>, alpha<span class="op">=</span><span class="fl">0.05</span>, power<span class="op">=</span><span class="fl">0.9</span>, GTE<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "sample size in treatment 1 = 66"</span></span>
<span><span class="co">#&gt; [1] "sample size in treatment 2 = 100"</span></span>
<span><span class="co">#&gt; [1] "unbiased estimate of GTE = 0.231388888888889"</span></span>
<span><span class="co">#&gt; $n1</span></span>
<span><span class="co">#&gt; [1] 66</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n2</span></span>
<span><span class="co">#&gt; [1] 100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $theta.pilot</span></span>
<span><span class="co">#&gt; [1] 0.2541667 0.3083333 0.1316667</span></span></code></pre></div>
<p>In order to attain 0.05 significance level with 90% power in two
sided hypothesis testing, we would need 66 participants in group 1 nd
100 participants in group 2.</p>
<p><strong>Sample size estimation when no historical data are
available</strong></p>
<p>We could use N.GSTnoData function to derive the sample size when
there is no pilot data.</p>
<p>Functions required inputs are: 1. k: number of endpoints 2. r0:
randomization ratio = n2/n1 3. GTE: target GTE where power is controlled
4. sigma2: upper bound of variances F1(X2) and F2(X1) 5. rho: Spearman
rank correlation 6. alpha: type I error 7. power: desired statistical
power 8. test.side: 1(one-sided test) or 2 (two-sided test)</p>
<p>Using the same hypothetical summary statistics using normal
approximation before:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">summary_data</span>, </span>
<span>      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Outcome scale"</span>, <span class="st">"Placebo Mean"</span>, <span class="st">"Placebo SD"</span>, <span class="st">"Treatment Mean"</span>, <span class="st">"Treatment SD"</span><span class="op">)</span>, </span>
<span>      align <span class="op">=</span> <span class="st">'c'</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="21%">
<col width="19%">
<col width="16%">
<col width="22%">
<col width="19%">
</colgroup>
<thead><tr class="header">
<th align="center">Outcome scale</th>
<th align="center">Placebo Mean</th>
<th align="center">Placebo SD</th>
<th align="center">Treatment Mean</th>
<th align="center">Treatment SD</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">Outcome 1</td>
<td align="center">30</td>
<td align="center">3</td>
<td align="center">10</td>
<td align="center">5</td>
</tr>
<tr class="even">
<td align="center">Outcome 2</td>
<td align="center">40</td>
<td align="center">4</td>
<td align="center">40</td>
<td align="center">6</td>
</tr>
<tr class="odd">
<td align="center">Outcome 3</td>
<td align="center">50</td>
<td align="center">5</td>
<td align="center">70</td>
<td align="center">7</td>
</tr>
</tbody>
</table>
<p>We can calculate GTE and sigma2, then plug them into the function to
get sample size estimation.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">GTE</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span></span>
<span><span class="va">sigma2</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">theta</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">12</span><span class="op">)</span> </span>
<span><span class="co"># rest of the variables are pre-determined:</span></span>
<span><span class="va">k</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mu1</span><span class="op">)</span> <span class="co"># number of endpoints</span></span>
<span><span class="va">alpha</span><span class="op">&lt;-</span> <span class="fl">0.05</span> <span class="co"># type I error</span></span>
<span><span class="va">beta</span><span class="op">&lt;-</span> <span class="fl">0.1</span> <span class="co"># 90% power</span></span>
<span><span class="va">test.side</span><span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">r0</span><span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># randomization ratio</span></span>
<span><span class="va">rho</span><span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="fu"><a href="../reference/N.GSTnoData.html">N.GSTnoData</a></span><span class="op">(</span><span class="va">k</span>, <span class="va">r0</span>, <span class="va">GTE</span>, <span class="va">sigma2</span>, <span class="va">rho</span>, <span class="va">alpha</span>, <span class="va">beta</span>, <span class="va">test.side</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "sample size in treatment 1 = 2914"</span></span>
<span><span class="co">#&gt; [1] "sample size in treatment 2 = 2913"</span></span>
<span><span class="co">#&gt; $n1</span></span>
<span><span class="co">#&gt; [1] 2914</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n2</span></span>
<span><span class="co">#&gt; [1] 2913</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $N</span></span>
<span><span class="co">#&gt; [1] 5827</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="part-iii--use-of-global-statistical-testing-in-data-analysis">Part III. Use of global statistical testing in data analysis<a class="anchor" aria-label="anchor" href="#part-iii--use-of-global-statistical-testing-in-data-analysis"></a>
</h3>
<p>In previous sections, we’ve determined appropriate <span class="math inline">\(\bar{\theta_a}\)</span> for the target magnitude
of treatment effect, set up the hypotheses, computed the sample size
needed, and now, we can test the treatment’s global effect by
determining test statistics using GST.parameter function.</p>
<p>The p-value of the GST is obtained by comparing the value of Z to
critical values from normal distribution.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get p-value from GST:</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GST.parameter.html">GST.parameter</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">n1</span><span class="op">)</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">theta</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">Sigma</span><span class="op">)</span></span>
<span><span class="va">Z</span></span>
<span><span class="co">#&gt; [1] 1.827365</span></span></code></pre></div>
<p>Alternatively, GST function could directly provide one/two-sided
non-parametric global statistical test p-values.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/GST.html">GST</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">data</span>, m<span class="op">=</span><span class="va">n1</span>, test.side <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; $p.value</span></span>
<span><span class="co">#&gt; [1] 0.004514176</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $h</span></span>
<span><span class="co">#&gt; [1] 0.9225368</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $theta.hat</span></span>
<span><span class="co">#&gt; [1] 0.2541667 0.3083333 0.1316667</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $GTE</span></span>
<span><span class="co">#&gt; [1] 0.2313889</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sigmaGTE</span></span>
<span><span class="co">#&gt; [1] 0.09187831</span></span></code></pre></div>
<p>GST.simu</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span><span class="op">&lt;-</span> <span class="fl">50</span> <span class="co"># sample size in treatment group 1</span></span>
<span><span class="va">n</span><span class="op">&lt;-</span>  <span class="fl">50</span> <span class="co"># sample size in treatment group 2</span></span>
<span><span class="va">k</span><span class="op">&lt;-</span> <span class="fl">20</span> <span class="co"># number of endpoints</span></span>
<span><span class="va">r</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">k</span><span class="op">)</span></span>
<span><span class="va">rho</span><span class="op">&lt;-</span> <span class="fl">0.01</span> <span class="co"># correlation</span></span>
<span><span class="va">simu</span><span class="op">&lt;-</span> <span class="fl">5</span></span>
<span></span>
<span><span class="va">i</span><span class="op">&lt;-</span><span class="fl">1</span></span>
<span><span class="va">dataset</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">m</span><span class="op">+</span><span class="va">n</span><span class="op">)</span><span class="op">*</span><span class="va">k</span><span class="op">*</span><span class="va">simu</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span> , dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">m</span><span class="op">+</span><span class="va">n</span>,<span class="va">k</span>, <span class="va">simu</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">k</span><span class="op">)</span> <span class="co">#introduce correlation for group 1</span></span>
<span> <span class="op">{</span><span class="va">dataset</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">m</span>,<span class="va">j</span>,<span class="op">]</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">rho</span><span class="op">)</span><span class="op">*</span><span class="va">dataset</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">m</span>,<span class="fl">1</span>,<span class="op">]</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">rho</span><span class="op">)</span><span class="op">*</span><span class="va">dataset</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">m</span>,<span class="va">j</span>,<span class="op">]</span></span>
<span> <span class="op">}</span></span>
<span><span class="va">dataset</span><span class="op">[</span><span class="op">(</span><span class="va">m</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">m</span><span class="op">+</span><span class="va">n</span><span class="op">)</span>,<span class="fl">1</span>,<span class="op">]</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">simu</span>,<span class="fl">0</span>,<span class="va">r</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, nrow<span class="op">=</span><span class="va">n</span>,ncol<span class="op">=</span><span class="va">simu</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">k</span><span class="op">)</span> <span class="co">#introduce correlation for group 2</span></span>
<span><span class="op">{</span> <span class="va">dataset</span><span class="op">[</span><span class="op">(</span><span class="va">m</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">m</span><span class="op">+</span><span class="va">n</span><span class="op">)</span>,<span class="va">j</span>,<span class="op">]</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">rho</span><span class="op">)</span><span class="op">*</span><span class="va">dataset</span><span class="op">[</span><span class="op">(</span><span class="va">m</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">m</span><span class="op">+</span><span class="va">n</span><span class="op">)</span>,<span class="fl">1</span>,<span class="op">]</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">rho</span><span class="op">)</span><span class="op">*</span></span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">simu</span>,<span class="fl">0</span>,<span class="va">r</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>, nrow<span class="op">=</span><span class="va">n</span>,ncol<span class="op">=</span><span class="va">simu</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">delta</span><span class="op">&lt;-</span> <span class="fl">0.15</span> <span class="co"># introduce difference between group 1 and group 2</span></span>
<span><span class="va">dataset</span><span class="op">[</span><span class="op">(</span><span class="va">m</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">m</span><span class="op">+</span><span class="va">n</span><span class="op">)</span>,,<span class="op">]</span><span class="op">&lt;-</span> <span class="va">dataset</span><span class="op">[</span><span class="op">(</span><span class="va">m</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">m</span><span class="op">+</span><span class="va">n</span><span class="op">)</span>,,<span class="op">]</span><span class="op">+</span><span class="va">delta</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span> <span class="co">#[1] 100  20   5</span></span>
<span><span class="co">#&gt; [1] 100  20   5</span></span>
<span></span>
<span><span class="co"># GST from simulated data:</span></span>
<span><span class="va">x</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/GST.simu.html">GST.simu</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">dataset</span>,<span class="va">m</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Peng Huang, Jiaxin Huang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
